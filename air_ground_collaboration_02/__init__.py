"""
Second version of the algorithm
"""